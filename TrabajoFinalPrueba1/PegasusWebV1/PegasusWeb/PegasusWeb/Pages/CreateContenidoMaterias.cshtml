@page
@using PegasusWeb.Entities
@model PegasusWeb.Pages.CreateContenidoMateriasModel
@{
    var esEdicion = Model.Contenido.Id > 0;
    var titulo = esEdicion ? "Editar Contenido" : "Cargar Nuevo Contenido";
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Cursos</title>
</head>
<body>
    <h4>@titulo</h4>
    <hr />

    <form method="post" onsubmit="handleSubmit(event)" id="form">
        <input type="hidden" name="id" asp-for="Contenido.Id" />
        <input type="hidden" name="materia" asp-for="@Model.IdMateria" />
        <table>
            <tr>
                <td>Titulo</td>
                <td><input type="text" asp-for="Contenido.Titulo" class="form-control" name="titulo" id="titulo" /></td>
            </tr>
            <tr>
                <td>Descripcion</td>
                <td>
                    <textarea asp-for="Contenido.Descripcion" id="descripcion" class="form-control" name="descripcion" rows="4" cols="50" maxlength="200" placeholder="Máximo 200 caracteres" required></textarea>
                </td>
            </tr>
        </table>
        <button type="submit" class="btn btn-primary">Guardar</button>
    </form>
    
</body>
</html>

@section scripts{
    <script>
        function validateForm() {
            const titulo = document.querySelector('#titulo').value.trim();
            const descripcion = document.querySelector('#descripcion').value.trim();

            if (titulo === '' || descripcion === '') {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Por favor, completa todos los campos.',
                    width: '350px',
                    padding: '20px',
                    customClass: {
                        title: 'my-custom-title',
                        confirmButton: "btn btn-danger",
                    }
                });
                return false;
            }
            return true;
        }

        function handleSubmit(event) {
            event.preventDefault(); 
            if (validateForm()) {
                Swal.fire({
                    icon: "success",
                    title: "Guardado",
                    showConfirmButton: false,
                    width: '300px',
                    padding: '20px',
                    timer: 1500,
                    customClass: {
                        title: 'my-custom-title',
                    }
                }).then(() => {
                    document.getElementById('form').submit(); 
                });
            }
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
}